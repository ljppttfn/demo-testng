package lj.study.test.tmp;

import com.alibaba.fastjson.JSONObject;
import org.testng.Assert;
import org.testng.annotations.Test;

public class TestMath {
    @Test
    public void test1(){
        Assert.assertEquals(1.0, Math.ceil(3/2));
        Assert.assertEquals(2.0, Math.ceil(3 * 1.0 /2));
        Assert.assertEquals(-0.0, Math.ceil(-1.0 / 2));
    }

    public void analyseTotalResult(JSONObject json){
        for(String key_singleFile: json.keySet()){
            JSONObject res_singleFile = json.getJSONObject(key_singleFile);
            for(String key_taskType: res_singleFile.keySet()){
                JSONObject json_taskType = res_singleFile.getJSONObject(key_taskType);
                float avg_cost_minio = 0;
                float avg_cost_fastdfs = 0;
                for(String key_task : json_taskType.keySet()){
                    if(key_task.contains("_minio")){
                        avg_cost_minio = json_taskType.getJSONObject(key_task).getFloat("task_avg_cost");
                    }
                    else if(key_task.contains("_fastdfs")){
                        avg_cost_fastdfs = json_taskType.getJSONObject(key_task).getFloat("task_avg_cost");
                    }
                }

                json_taskType.put("minio_vs_fastdfs", (avg_cost_fastdfs - avg_cost_minio) / avg_cost_fastdfs * 100);
            }

        }
    }

    @Test
    public void test2(){
        String s = "{\"512000\":{\"download\":{\"download_fastdfs, 单文件：512000，文件总数：20，线程数：20\":{\"task_avg_cost\":\"86895.8500\",\"total_fileNums\":20,\"task_id\":\"task_1637312049354\",\"task_total_cost\":\"90058\",\"success_fileNums\":\"20\"},\"download_minio, 单文件：512000，文件总数：20，线程数：20\":{\"task_avg_cost\":\"87626.2000\",\"total_fileNums\":20,\"task_id\":\"task_1637311496625\",\"task_total_cost\":\"89200\",\"success_fileNums\":\"20\"}},\"upload\":{\"upload_minio, 单文件：512000，文件总数：20，线程数：20\":{\"task_avg_cost\":\"71590.7500\",\"total_fileNums\":20,\"task_id\":\"task_1637311286027\",\"task_total_cost\":\"89377\",\"success_fileNums\":\"20\"},\"upload_fastdfs, 单文件：512000，文件总数：20，线程数：20\":{\"task_avg_cost\":\"80562.1500\",\"total_fileNums\":20,\"task_id\":\"task_1637311832034\",\"task_total_cost\":\"93316\",\"success_fileNums\":\"20\"}},\"delete\":{\"delete_minio, 单文件：512000，文件总数：20，线程数：20\":{\"task_avg_cost\":\"334.4500\",\"total_fileNums\":20,\"task_id\":\"task_1637311286027\",\"task_total_cost\":\"89377\",\"success_fileNums\":\"20\"},\"delete_fastdfs, 单文件：512000，文件总数：20，线程数：20\":{\"task_avg_cost\":\"920.7500\",\"total_fileNums\":20,\"task_id\":\"task_1637311832034\",\"task_total_cost\":\"93316\",\"success_fileNums\":\"20\"}}},\"100\":{\"download\":{\"download_minio, 单文件：100，文件总数：10000，线程数：20\":{\"task_avg_cost\":\"39.5025\",\"total_fileNums\":10000,\"task_id\":\"task_1637304526191\",\"task_total_cost\":\"64975\",\"success_fileNums\":\"10000\"},\"download_fastdfs, 单文件：100，文件总数：10000，线程数：20\":{\"task_avg_cost\":\"12.1719\",\"total_fileNums\":10000,\"task_id\":\"task_1637305162165\",\"task_total_cost\":\"50502\",\"success_fileNums\":\"10000\"}},\"upload\":{\"upload_minio, 单文件：100，文件总数：10000，线程数：20\":{\"task_avg_cost\":\"15.8922\",\"total_fileNums\":10000,\"task_id\":\"task_1637304305526\",\"task_total_cost\":\"99334\",\"success_fileNums\":\"10000\"},\"upload_fastdfs, 单文件：100，文件总数：10000，线程数：20\":{\"task_avg_cost\":\"97.5615\",\"total_fileNums\":10000,\"task_id\":\"task_1637304881640\",\"task_total_cost\":\"157252\",\"success_fileNums\":\"10000\"}},\"delete\":{\"delete_fastdfs, 单文件：100，文件总数：10000，线程数：20\":{\"task_avg_cost\":\"2.9659\",\"total_fileNums\":10000,\"task_id\":\"task_1637304881640\",\"task_total_cost\":\"157252\",\"success_fileNums\":\"10000\"},\"delete_minio, 单文件：100，文件总数：10000，线程数：20\":{\"task_avg_cost\":\"4.8079\",\"total_fileNums\":10000,\"task_id\":\"task_1637304305526\",\"task_total_cost\":\"99334\",\"success_fileNums\":\"10000\"}}},\"1024\":{\"download\":{\"download_minio, 单文件：1024，文件总数：10000，线程数：20\":{\"task_avg_cost\":\"111.2827\",\"total_fileNums\":10000,\"task_id\":\"task_1637305773608\",\"task_total_cost\":\"108123\",\"success_fileNums\":\"10000\"},\"download_fastdfs, 单文件：1024，文件总数：10000，线程数：20\":{\"task_avg_cost\":\"138.0689\",\"total_fileNums\":10000,\"task_id\":\"task_1637306479530\",\"task_total_cost\":\"114317\",\"success_fileNums\":\"10000\"}},\"upload\":{\"upload_fastdfs, 单文件：1024，文件总数：10000，线程数：20\":{\"task_avg_cost\":\"194.8773\",\"total_fileNums\":10000,\"task_id\":\"task_1637306168996\",\"task_total_cost\":\"190022\",\"success_fileNums\":\"10000\"},\"upload_minio, 单文件：1024，文件总数：10000，线程数：20\":{\"task_avg_cost\":\"101.2804\",\"total_fileNums\":10000,\"task_id\":\"task_1637305502951\",\"task_total_cost\":\"147358\",\"success_fileNums\":\"10000\"}},\"delete\":{\"delete_minio, 单文件：1024，文件总数：10000，线程数：20\":{\"task_avg_cost\":\"5.0771\",\"total_fileNums\":10000,\"task_id\":\"task_1637305502951\",\"task_total_cost\":\"147358\",\"success_fileNums\":\"10000\"},\"delete_fastdfs, 单文件：1024，文件总数：10000，线程数：20\":{\"task_avg_cost\":\"5.7147\",\"total_fileNums\":10000,\"task_id\":\"task_1637306168996\",\"task_total_cost\":\"190022\",\"success_fileNums\":\"10000\"}}},\"10240\":{\"download\":{\"download_minio, 单文件：10240，文件总数：1000，线程数：20\":{\"task_avg_cost\":\"1724.9350\",\"total_fileNums\":1000,\"task_id\":\"task_1637307095693\",\"task_total_cost\":\"89309\",\"success_fileNums\":\"1000\"},\"download_fastdfs, 单文件：10240，文件总数：1000，线程数：20\":{\"task_avg_cost\":\"1722.4870\",\"total_fileNums\":1000,\"task_id\":\"task_1637307656496\",\"task_total_cost\":\"89245\",\"success_fileNums\":\"1000\"}},\"upload\":{\"upload_fastdfs, 单文件：10240，文件总数：1000，线程数：20\":{\"task_avg_cost\":\"1792.4310\",\"total_fileNums\":1000,\"task_id\":\"task_1637307435872\",\"task_total_cost\":\"97967\",\"success_fileNums\":\"1000\"},\"upload_minio, 单文件：10240，文件总数：1000，线程数：20\":{\"task_avg_cost\":\"1630.8970\",\"total_fileNums\":1000,\"task_id\":\"task_1637306885106\",\"task_total_cost\":\"89397\",\"success_fileNums\":\"1000\"}},\"delete\":{\"delete_minio, 单文件：10240，文件总数：1000，线程数：20\":{\"task_avg_cost\":\"11.9770\",\"total_fileNums\":1000,\"task_id\":\"task_1637306885106\",\"task_total_cost\":\"89397\",\"success_fileNums\":\"1000\"},\"delete_fastdfs, 单文件：10240，文件总数：1000，线程数：20\":{\"task_avg_cost\":\"21.4420\",\"total_fileNums\":1000,\"task_id\":\"task_1637307435872\",\"task_total_cost\":\"97967\",\"success_fileNums\":\"1000\"}}},\"51200\":{\"download\":{\"download_fastdfs, 单文件：51200，文件总数：200，线程数：20\":{\"task_avg_cost\":\"8729.6533\",\"total_fileNums\":200,\"task_id\":\"task_1637308757862\",\"task_total_cost\":\"88784\",\"success_fileNums\":\"199\"},\"download_minio, 单文件：51200，文件总数：200，线程数：20\":{\"task_avg_cost\":\"8730.3150\",\"total_fileNums\":200,\"task_id\":\"task_1637308207125\",\"task_total_cost\":\"89214\",\"success_fileNums\":\"200\"}},\"upload\":{\"upload_fastdfs, 单文件：51200，文件总数：200，线程数：20\":{\"task_avg_cost\":\"9127.7085\",\"total_fileNums\":200,\"task_id\":\"task_1637308542247\",\"task_total_cost\":\"94001\",\"success_fileNums\":\"199\"},\"upload_minio, 单文件：51200，文件总数：200，线程数：20\":{\"task_avg_cost\":\"8655.8850\",\"total_fileNums\":200,\"task_id\":\"task_1637307996692\",\"task_total_cost\":\"89370\",\"success_fileNums\":\"200\"}},\"delete\":{\"delete_minio, 单文件：51200，文件总数：200，线程数：20\":{\"task_avg_cost\":\"40.8650\",\"total_fileNums\":200,\"task_id\":\"task_1637307996692\",\"task_total_cost\":\"89370\",\"success_fileNums\":\"200\"},\"delete_fastdfs, 单文件：51200，文件总数：200，线程数：20\":{\"task_avg_cost\":\"85.4774\",\"total_fileNums\":200,\"task_id\":\"task_1637308542247\",\"task_total_cost\":\"94001\",\"success_fileNums\":\"199\"}}},\"102400\":{\"download\":{\"download_minio, 单文件：102400，文件总数：100，线程数：20\":{\"task_avg_cost\":\"17478.6400\",\"total_fileNums\":100,\"task_id\":\"task_1637309303659\",\"task_total_cost\":\"89229\",\"success_fileNums\":\"100\"},\"download_fastdfs, 单文件：102400，文件总数：100，线程数：20\":{\"task_avg_cost\":\"17466.8300\",\"total_fileNums\":100,\"task_id\":\"task_1637309854389\",\"task_total_cost\":\"89214\",\"success_fileNums\":\"100\"}},\"upload\":{\"upload_minio, 单文件：102400，文件总数：100，线程数：20\":{\"task_avg_cost\":\"16981.4200\",\"total_fileNums\":100,\"task_id\":\"task_1637309092996\",\"task_total_cost\":\"89521\",\"success_fileNums\":\"100\"},\"upload_fastdfs, 单文件：102400，文件总数：100，线程数：20\":{\"task_avg_cost\":\"17902.7300\",\"total_fileNums\":100,\"task_id\":\"task_1637309638799\",\"task_total_cost\":\"94411\",\"success_fileNums\":\"100\"}},\"delete\":{\"delete_minio, 单文件：102400，文件总数：100，线程数：20\":{\"task_avg_cost\":\"72.0400\",\"total_fileNums\":100,\"task_id\":\"task_1637309092996\",\"task_total_cost\":\"89521\",\"success_fileNums\":\"100\"},\"delete_fastdfs, 单文件：102400，文件总数：100，线程数：20\":{\"task_avg_cost\":\"225.4800\",\"total_fileNums\":100,\"task_id\":\"task_1637309638799\",\"task_total_cost\":\"94411\",\"success_fileNums\":\"100\"}}},\"204800\":{\"download\":{\"download_fastdfs, 单文件：204800，文件总数：50，线程数：20\":{\"task_avg_cost\":\"32339.0200\",\"total_fileNums\":50,\"task_id\":\"task_1637310950811\",\"task_total_cost\":\"89201\",\"success_fileNums\":\"50\"},\"download_minio, 单文件：204800，文件总数：50，线程数：20\":{\"task_avg_cost\":\"32358.9800\",\"total_fileNums\":50,\"task_id\":\"task_1637310400030\",\"task_total_cost\":\"89207\",\"success_fileNums\":\"50\"}},\"upload\":{\"upload_fastdfs, 单文件：204800，文件总数：50，线程数：20\":{\"task_avg_cost\":\"34607.6000\",\"total_fileNums\":50,\"task_id\":\"task_1637310735193\",\"task_total_cost\":\"92619\",\"success_fileNums\":\"50\"},\"upload_minio, 单文件：204800，文件总数：50，线程数：20\":{\"task_avg_cost\":\"32501.7400\",\"total_fileNums\":50,\"task_id\":\"task_1637310189542\",\"task_total_cost\":\"89646\",\"success_fileNums\":\"50\"}},\"delete\":{\"delete_minio, 单文件：204800，文件总数：50，线程数：20\":{\"task_avg_cost\":\"135.2800\",\"total_fileNums\":50,\"task_id\":\"task_1637310189542\",\"task_total_cost\":\"89646\",\"success_fileNums\":\"50\"},\"delete_fastdfs, 单文件：204800，文件总数：50，线程数：20\":{\"task_avg_cost\":\"551.4800\",\"total_fileNums\":50,\"task_id\":\"task_1637310735193\",\"task_total_cost\":\"92619\",\"success_fileNums\":\"50\"}}}}";
        JSONObject json = JSONObject.parseObject(s);
        analyseTotalResult(json);

        System.out.println(json.toJSONString());
    }
}
